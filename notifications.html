    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Last Stamped Display</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <style>
            body { font-family: 'Inter', sans-serif; background-color: transparent; }
        </style>
    </head>
    <body class="bg-transparent flex flex-col items-center justify-center min-h-screen p-4">
    
        <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-sm text-center">
            <h2 class="text-xl font-semibold text-gray-700 mb-2">Last Friend Stamped:</h2>
            <div id="last-stamped-name" class="text-4xl font-extrabold text-blue-600 animate-pulse transition-transform duration-500">
                Loading...
            </div>
            
            <!-- This is a message box for errors or status updates -->
            <div id="status-message" class="mt-4 text-sm text-red-600 hidden"></div>
        </div>
    
        <script>
            // PASTE YOUR GOOGLE SHEET ID HERE
            const SHEET_ID = '1TwKoCPQuzcxN0DMhi9eC9aG9EOV8JtYWZnbFqT-FRkc';
    
            // Polling interval in milliseconds (e.g., check every 5 seconds)
            const POLLING_INTERVAL = 5000;
            
            let lastDisplayedName = '';
            let statusMessageDiv = document.getElementById('status-message');
            let lastStampedNameDiv = document.getElementById('last-stamped-name');
    
            /**
             * Displays a status message on the page.
             * @param {string} message The message to display.
             * @param {string} type 'success' or 'error'.
             */
            function displayMessage(message, type) {
                statusMessageDiv.textContent = message;
                statusMessageDiv.classList.remove('hidden', 'text-green-600', 'text-red-600');
                if (type === 'error') {
                    statusMessageDiv.classList.add('text-red-600');
                } else {
                    statusMessageDiv.classList.add('text-green-600');
                }
            }
    
            /**
             * Fetches the name of the last person logged from the Google Sheet.
             */
            async function fetchLastStampedName() {
                const logUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=Attendance%20Log`;
                try {
                    const response = await fetch(logUrl);
                    if (!response.ok) {
                         throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const text = await response.text();
                    
                    const jsonText = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
                    const data = JSON.parse(jsonText);
                    const logCount = data.table.rows.length;
                    
                    if (logCount > 0) {
                        const lastRow = data.table.rows[logCount - 1];
                        return lastRow.c[1].v; // Column 2 (index 1) is "Friend's Name"
                    }
                    
                    return 'No Stamps Yet';
                } catch (error) {
                    displayMessage(`Error: Could not load data. Ensure the Google Sheet is publicly shared.`, 'error');
                    console.error('Error fetching data:', error);
                    return null;
                }
            }
    
            /**
             * Updates the display with the latest stamped name.
             */
            async function updateLastStampedDisplay() {
                const latestName = await fetchLastStampedName();
    
                if (latestName && latestName !== lastDisplayedName) {
                    // Animate the update
                    lastStampedNameDiv.classList.remove('animate-pulse');
                    lastStampedNameDiv.classList.add('transition-transform', 'duration-500', 'transform', 'scale-110');
                    
                    setTimeout(() => {
                        lastStampedNameDiv.textContent = latestName;
                        lastStampedNameDiv.classList.remove('scale-110');
                        lastStampedNameDiv.classList.add('animate-pulse');
                    }, 500); // Wait for the scaling to complete before changing text
                    
                    lastDisplayedName = latestName;
                }
            }
            
            // Initial fetch and start the polling process
            window.onload = async function() {
                await updateLastStampedDisplay();
                setInterval(updateLastStampedDisplay, POLLING_INTERVAL);
            };
        </script>
    </body>
    </html>
    
